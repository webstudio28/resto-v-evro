# Frontend Audit – Phase 1 Step 1

Reference snapshot of the existing React/Vite codebase prior to Phase 1 execution. Use this to guide PWA enhancements, activation gating, and telemetry work.

## Tooling & Build
- **Bundler / Dev server:** Vite 7 (`vite.config.ts`).
- **Language:** TypeScript 5.8 + React 19 (function components only).
- **Entry point:** `src/main.tsx` mounts `<App />` with `StrictMode`.
- **Scripts (`package.json`):**
  - `npm run dev` → `vite`
  - `npm run build` → `tsc -b && vite build`
  - `npm run preview` → `vite preview`
  - `npm run lint` → `eslint .`
- **Styling:** TailwindCSS 3.4 via `src/index.css` + utility classes in JSX. No component library.
- **State mgmt:** React hooks (`useState`, `useMemo`, `useEffect`); no global store or router.
- **Testing:** No testing libs configured yet (no Vitest/Jest/Cypress installed).

## Routing & App Structure
- Single-page experience; no React Router setup.
- `App.tsx` renders the entire calculator UI (language/theme switcher, inputs, keypad).
- Mobile keypad toggled via component state; calculations happen locally.
- Future activation gating will likely wrap `<App />` or split into routes once introduced.

## Persistence & Client Storage
- Theme preference stored in `localStorage` under `theme`.
- No other persistent keys yet (no device ID, activation token, telemetry cache).
- Custom hook `useTheme` handles system-prefers-dark detection.

## Network Calls
- None at present; the calculator is fully client-side.
- Service worker currently precaches build assets (generated by `vite-plugin-pwa`), but the app makes no fetches other than asset loading.
- Activation API, telemetry endpoints, etc., do not exist yet—safe to stub during Phase 1.

## PWA Status
- `vite-plugin-pwa` already configured with:
  - `registerType: 'autoUpdate'`
  - Workbox glob patterns for precache
  - Basic manifest inline in config (name, short name, theme/background colors).
- Placeholder icons referenced (`/icon-192.png`, `/icon-512.png`) but not present in `public/`.
- Build output (`dist/manifest.webmanifest`, `registerSW.js`, `sw.js`) exists, indicating plugin is active.
- Missing UX pieces:
  - No custom install prompt handling (`beforeinstallprompt` not used).
  - No offline fallback view or update notification UI.
  - No manifest file checked into repo yet (only config inline).

## Assets & Branding
- `public/` currently contains only `vite.svg`.
- No branded icons, splash screens, or maskable assets committed.
- Tailwind theme uses neutral + navy colors but not centralized tokens.

## Known Gaps / Risks
- Without a router or modular structure, adding ActivationGate may require refactoring `App.tsx`.
- Lack of testing makes regression risk high once service worker/offline flows are introduced.
- No environment flag infrastructure; need plan for feature flags (e.g., Vite env vars).
- PWA plugin works in build, but dev experience (HMR with SW) untested.

## Immediate Next Actions (Phase 1)
1. Produce branded icon set + standalone `manifest.json` synced with Vite config.
2. Decide Workbox strategy (likely keep `vite-plugin-pwa` but customize caching + offline fallback).
3. Introduce architecture for device ID + activation storage (new context/provider).
4. Add install/update UX and telemetry scaffolding per PHASE1 plan.

